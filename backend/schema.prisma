datasource db {
    // could be postgresql or mysql
    provider = "sqlite"
    url      = "file:dev.db"
}

generator db {
    provider = "go run github.com/steebchen/prisma-client-go"
}


// A user has multiple applications
// An application has multiple stages
// A stage has question types / descriptions one can provide to generate questions
// A question has multiple categories (behavioral, system design, algorithms, etc.)

// Search questionbank for questions that match the categories and stages of the application
// Perform vector search?

model User {
    id String @id @default(cuid())

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    username  String   @unique

    applications Application[]
}

// n to 1 relation from apps to user
model Application {
    id String @id @default(cuid())

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    name        String
    description String

    url  String
    icon String

    owner   User   @relation(fields: [ownerId], references: [id])
    ownerId String

    stages ApplicationStage[]
}

// n to 1 relation from stages to apps
model ApplicationStage {
    id String @id @default(cuid())

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    name        String
    description String

    application   Application @relation(fields: [applicationId], references: [id])
    applicationId String
}

model Question {
    id    Int    @id @default(autoincrement())
    title String

    categories CategoriesOnQuestion[]
}

// categories are like ['behavioral', 'system design', 'algorithms', etc.]
model Category {
    id    String                 @id
    name  String
    posts CategoriesOnQuestion[]
}

model CategoriesOnQuestion {
    questionBank Question @relation(fields: [questionId], references: [id])
    questionId   Int // relation scalar field (used in the `@relation` attribute above)

    category   Category @relation(fields: [categoryId], references: [id])
    categoryId String // relation scalar field (used in the `@relation` attribute above)

    assignedAt DateTime @default(now())
    assignedBy String

    @@id([categoryId, questionId])
}
